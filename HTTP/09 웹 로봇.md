# 09. 웹 로봇

- 웹 로봇: 사람과의 상호작용 없이 연속된 웹 트랜잭션들을 자동으로 수행하는 소프트웨어 프로그램이다. 많은 로봇이 웹 사이트에서 다른 웹 사이트로 떠돌아다니면서 
  - 콘텐츠를 가져오고
  - 하이퍼링크를 따라가고
  - 그들이 발견한 데이터를 처리한다.
- 웹 로봇의 몇 가지 예
  - 주식시장 서버에 매 분 HTTP GET 요청을 보내 응답받은 데이터를 활용하여 주가 추이 그래프를 생성하는 주식 그래프 로봇
  - WWW의 규모와 진화에 대한 통계 정보를 수집하는 웹 통계 조사 로봇
    - 웹을 떠돌면서 페이지의 개수를 세고, 각 페이지의 크기, 언어, 미디어 타입을 기록
  - 검색 DB를 만들기 위해 발견한 모든 문서를 수집하는 검색엔진 로봇
  - 상품에 대한 가격 DB를 만들기 위해 온라인 쇼핑몰의 카탈로그에서 웹페이지를 수집하는 가격 비교 로봇

### 9.1 크롤러와 크롤링

![IMG_9794](/Users/mina/Downloads/IMG_9794.JPG)웹 링크를 재귀적으로 따라가는 로봇을 크롤러 혹은 스파이더라고 부르는데, HTML 하이퍼링크들로 만들어진 웹을 따라 '기어다니기(crawl)' 때문이다.

인터넷 검색엔진은 웹을 돌아다니면서 모든 문서를 끌어오기 위해 크롤러를 사용한다. (검색엔진 스파이더들은 가장 복잡한 로봇들 중 하나이다.)

웹의 대부분을 커버하기 위해 루트 집합에 너무 많은 페이지가 있을 필요는 없다. 일반적으로 좋은 루트 집합은 

- 크고 인기 있는 웹사이트, 
- 새로 생성된 페이지들의 목록, 
- 그리고 자주 링크되지 않는 잘 알려져있지 않은 페이지들의 목록으로 구성되어있다.

### 9.2 로봇의 HTTP

로봇들은 HTTP 클라이언트 프로그램과 같다. (HTTP 명세의 규칙을 지켜야 함)

다만, 로봇 구현 시 로봇의 능력, 신원, 출신을 알려주는 몇 가지 헤더를 사이트에게 보내주는 것이 좋다. 

**<신원 식별 헤더>**

- User-Agent: 서버에 요청한 로봇의 이름
- From: 로봇의 사용자/관리자의 이메일 주소 제공
- Accept: 서버에게 어떤 미디어타입을 보내도 되는지 명시
- Referer: 현재의 요청 URL을 포함한 문서의 URL을 제공

### 9.3 부적절하게 동작하는 로봇들

로봇이 저지를 수 있는 몇 가지 실수들

1. 폭주하는 로봇: 웹 서핑하는 사람보다 빠른 속도로 HTTP 요청을 만들 수 있기에 웹 서버에 극심한 부하를 줄 수 있다.
2. 오래된 URL: URL의 목록이 최신화 되었을 때 존재하지 않는 문서에 대한 접근 요청으로 에러 로그가 채워지거나, 서버 부하를 발생시킬 수 있다.
3. 길고 잘못된 URL: 순환(재귀)이나 프로그래밍 상의 오류로 인해 로봇은 웹사이트에 의미없는 URL을 요청할 수 있는데, 이 또한 서버에 영향을 준다.
4. 호기심이 지나친 로봇: 일반적으로 공개된 인터넷을 통해 리소스 접근이 가능하다면 인터넷에 링크가 존재하는 한 사적인 리소스(비공개 등)는 거의 없다. 사생활 침해로 여겨질 수 있다.
5. 동적 게이트웨이 접근: 로봇이 게이트웨이 애플리케이션의 콘텐츠에 대한 URL로 요청을 할 수 있는데, 이 경우에 처리 비용이 많이 발생한다. << ??

### 9.4 로봇 차단하기

![IMG_9795](/Users/mina/Downloads/IMG_9795.JPG)

robot.txt: 로봇의 접근으로 인해 문제 발생되지 않도록 사전에 로봇의 접근을 제어하는 정보를 저장하는 파일
이 파일은 어떤 로봇이 서버의 어떤 부분에 접근할 수 있는지에 대한 정보가 담겨있다.

### 9.5 로봇 에티켓

로봇 제작자들을 위한 가이드라인: http://www.robotstxt.org/

### 9.6 검색엔진

웹 로봇을 가장 광범위하게 사용하는 것은 인터넷 검색엔진이다. 웹 크롤러들은 검색엔진에게 웹에 존재하는 문서들을 가져다 주어서, 검색엔진이 어떤 문서에 어떤 단어들이 존재하는지에 대한 색인을 생성할 수 있게 한다.

<현대적인 검색엔진의 아키텍처 & 검색 절차> 
풀 텍스트 색인: 단어 하나를 입력받아 그 단어를 포함하는 문서를 알려줄 수 있는 DB

![IMG_9796](/Users/mina/Downloads/IMG_9796.JPG)

![IMG_9797](/Users/mina/Downloads/IMG_9797.JPG)

HTML 폼을 사용자가 채워 넣고 브라우저가 그 폼을 GET/POST 방식으로 게이트웨이로 보낸다. 게이트웨이 프로그램은 검색 질의를 추출하고 웹 UI 질의를 풀텍스트 색인을 검색할 때 사용되는 표현식으로 변환한다.

![IMG_9798](/Users/mina/Downloads/IMG_9798.JPG)

검색결과를 정렬하여 보여주기도 가능(웹 크롤링 과정에서 수집된 통계 데이터를 실제로 사용)

스푸핑: 웹마스터가 자신의 사이트가 검색엔진 상위에 노출되도록 편법을 사용한 것